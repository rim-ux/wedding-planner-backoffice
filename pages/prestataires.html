<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prestataires | Golden Promise</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;500&family=Montserrat:wght@300;500;600&family=Parisienne&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --rose-gold: #c5a059;
            --silk: #fcfaf8;
            --text: #2d2a26;
            --white: #ffffff;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--silk);
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 280px;
            background: var(--white);
            border-right: 1px solid rgba(197, 160, 89, 0.1);
            padding: 40px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        .logo {
            padding: 0 40px;
            margin-bottom: 30px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            letter-spacing: 3px;
        }
        .logo span {
            font-family: 'Parisienne', cursive;
            color: var(--rose-gold);
        }
        .menu-list { list-style: none; }
        .menu-item { padding: 0 20px; margin-bottom: 5px; }
        .menu-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 25px;
            color: var(--text);
            text-decoration: none;
            border-radius: 50px;
            font-size: 0.75rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            opacity: 0.6;
            transition: 0.3s;
        }
        .menu-link:hover, .menu-link.active {
            background: rgba(197, 160, 89, 0.1);
            opacity: 1;
        }
        .menu-link i { color: var(--rose-gold); }
        .logout-btn {
            margin: 30px 20px;
            padding: 15px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            border-radius: 50px;
            width: calc(100% - 40px);
            cursor: pointer;
            font-size: 0.75rem;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 60px;
        }
        header h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3rem;
            font-weight: 300;
            margin-bottom: 10px;
        }
        header p {
            font-family: 'Parisienne', cursive;
            font-size: 1.8rem;
            color: var(--rose-gold);
            margin-bottom: 40px;
        }
        .actions-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        .search-box {
            padding: 12px 20px;
            border: 2px solid rgba(197, 160, 89, 0.2);
            border-radius: 50px;
            width: 300px;
            outline: none;
        }
        .btn {
            padding: 12px 30px;
            background: var(--rose-gold);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.85rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-left: 10px;
        }
        .btn:hover { opacity: 0.9; }
        .table-container {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            text-align: left;
            padding: 20px;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--rose-gold);
            border-bottom: 2px solid var(--silk);
        }
        td {
            padding: 20px;
            border-bottom: 1px solid var(--silk);
        }
        tr:hover { background: var(--silk); }
        .badge {
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .badge-traiteur { background: rgba(239, 68, 68, 0.1); color: #ef4444; }
        .badge-decoration { background: rgba(197, 160, 89, 0.1); color: var(--rose-gold); }
        .badge-photo { background: rgba(59, 130, 246, 0.1); color: #3b82f6; }
        .badge-musique { background: rgba(245, 158, 11, 0.1); color: #F59E0B; }
        .action-btns {
            display: flex;
            gap: 10px;
        }
        .btn-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: none;
            background: var(--silk);
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-icon:hover {
            background: var(--rose-gold);
            color: white;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-content h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2rem;
            margin-bottom: 30px;
            color: var(--rose-gold);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(197, 160, 89, 0.2);
            border-radius: 10px;
            outline: none;
        }
        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        .btn-secondary {
            background: #ddd;
            color: var(--text);
        }
        
        /* Modal D√©tails */
        .detail-row {
            display: flex;
            padding: 15px 0;
            border-bottom: 1px solid var(--silk);
        }
        .detail-row:last-child {
            border-bottom: none;
        }
        .detail-label {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #999;
            width: 150px;
            font-weight: 600;
        }
        .detail-value {
            flex: 1;
            font-weight: 500;
            color: var(--text);
        }
        .rating {
            color: var(--rose-gold);
            font-size: 1.3rem;
        }
        
        /* RTL Support */
        body[dir="rtl"] .sidebar {
            border-right: none;
            border-left: 1px solid rgba(197, 160, 89, 0.1);
        }
        body[dir="rtl"] .main-content {
            margin-left: 0;
            margin-right: 280px;
        }
        body[dir="rtl"] .menu-link {
            flex-direction: row-reverse;
        }
        body[dir="rtl"] .actions-bar {
            flex-direction: row-reverse;
        }
        body[dir="rtl"] table {
            direction: rtl;
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="logo">Golden <span>Promise</span></div>
        
        <div style="padding: 0 20px; margin-bottom: 30px;">
            <select id="langSelect" onchange="setLang(this.value)" style="
                width: 100%;
                padding: 12px;
                border: 2px solid rgba(197, 160, 89, 0.2);
                border-radius: 50px;
                background: white;
                cursor: pointer;
                font-size: 0.85rem;
                outline: none;
                text-align: center;
            ">
                <option value="fr">üá´üá∑ Fran√ßais</option>
                <option value="en">üá¨üáß English</option>
                <option value="ar">üá≤üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
            </select>
        </div>

        <ul class="menu-list">
            <li class="menu-item">
                <a href="dashboard.html" class="menu-link">
                    <i class="fas fa-chart-line"></i> 
                    <span data-i18n="dashboard">Tableau de bord</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="clients.html" class="menu-link">
                    <i class="fas fa-users"></i> 
                    <span data-i18n="clients">Clients</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="mariages.html" class="menu-link">
                    <i class="fas fa-heart"></i> 
                    <span data-i18n="mariages">Mariages</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="prestataires.html" class="menu-link active">
                    <i class="fas fa-briefcase"></i> 
                    <span data-i18n="prestataires">Prestataires</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="paiements.html" class="menu-link">
                    <i class="fas fa-credit-card"></i> 
                    <span data-i18n="paiements">Paiements</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="messages.html" class="menu-link">
                    <i class="fas fa-envelope"></i> 
                    <span data-i18n="messages">Messages</span>
                </a>
            </li>
        </ul>
        <button class="logout-btn" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> 
            <span data-i18n="logout">D√©connexion</span>
        </button>
    </div>

    <div class="main-content">
        <header>
            <h1 data-i18n="prestataires_title">Gestion des Prestataires</h1>
            <p data-i18n="prestataires_subtitle">Liste de vos partenaires</p>
        </header>

        <div class="actions-bar">
            <input type="text" class="search-box" id="searchInput" data-i18n="search" placeholder="Rechercher...">
            <div>
                <button class="btn" onclick="openAddModal()">
                    <i class="fas fa-plus"></i> 
                    <span data-i18n="add_vendor">Ajouter Prestataire</span>
                </button>
                <button class="btn" onclick="exportCSV()">
                    <i class="fas fa-download"></i> 
                    <span data-i18n="export">Export CSV</span>
                </button>
            </div>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th data-i18n="id">ID</th>
                        <th data-i18n="name">Nom</th>
                        <th data-i18n="category">Cat√©gorie</th>
                        <th data-i18n="phone">T√©l√©phone</th>
                        <th data-i18n="email">Email</th>
                        <th data-i18n="rating">Note</th>
                        <th data-i18n="actions">Actions</th>
                    </tr>
                </thead>
                <tbody id="prestatairesTable"></tbody>
            </table>
        </div>
    </div>

    <!-- MODAL D√âTAILS -->
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <h2 data-i18n="vendor_details">üìã D√©tails du Prestataire</h2>
            <div class="detail-row">
                <span class="detail-label" data-i18n="name">Nom :</span>
                <span class="detail-value" id="detailNom">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label" data-i18n="category">Cat√©gorie :</span>
                <span class="detail-value" id="detailCategorie">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label" data-i18n="phone">T√©l√©phone :</span>
                <span class="detail-value" id="detailTel">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label" data-i18n="email">Email :</span>
                <span class="detail-value" id="detailEmail">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label" data-i18n="rating">Note :</span>
                <span class="detail-value rating" id="detailNote">-</span>
            </div>
            <div class="modal-actions">
                <button class="btn" onclick="closeDetailsModal()">
                    <i class="fas fa-times"></i> 
                    <span data-i18n="close">Fermer</span>
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL AJOUTER/MODIFIER -->
    <div id="vendorModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle" data-i18n="add_vendor_title">Ajouter un Prestataire</h2>
            <form id="vendorForm">
                <div class="form-group">
                    <label data-i18n="name">Nom</label>
                    <input type="text" id="nom" required>
                </div>
                <div class="form-group">
                    <label data-i18n="category">Cat√©gorie</label>
                    <select id="categorie" required>
                        <option value="traiteur">Traiteur</option>
                        <option value="decoration">D√©coration</option>
                        <option value="photo">Photographie</option>
                        <option value="musique">Musique</option>
                    </select>
                </div>
                <div class="form-group">
                    <label data-i18n="phone">T√©l√©phone</label>
                    <input type="tel" id="tel" required>
                </div>
                <div class="form-group">
                    <label data-i18n="email">Email</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label data-i18n="rating">Note (1-5)</label>
                    <input type="number" id="note" min="1" max="5" required>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn" data-i18n="save">Enregistrer</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()" data-i18n="cancel">Annuler</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function logout() {
            window.location.href = 'index.html';
        }

        // Donn√©es des prestataires
        const defaultPrestataires = [
            { id: 1, nom: "Traiteur Royal", categorie: "traiteur", tel: "+212 6 12 34 56 78", email: "contact@royal.ma", note: 5 },
            { id: 2, nom: "D√©cor Art", categorie: "decoration", tel: "+212 6 98 76 54 32", email: "info@decorart.ma", note: 4 },
            { id: 3, nom: "Photo Pro", categorie: "photo", tel: "+212 6 55 44 33 22", email: "photo@pro.ma", note: 5 },
            { id: 4, nom: "DJ Events", categorie: "musique", tel: "+212 6 77 88 99 00", email: "dj@events.ma", note: 4 }
        ];

        let allData = JSON.parse(localStorage.getItem('goldenpromise_data') || '{}');
        
        if (!allData.prestataires || allData.prestataires.length === 0) {
            allData.prestataires = defaultPrestataires;
            localStorage.setItem('goldenpromise_data', JSON.stringify(allData));
        }

        let prestataires = allData.prestataires;
        let editingId = null;

        const categorieClasses = {
            traiteur: 'badge-traiteur',
            decoration: 'badge-decoration',
            photo: 'badge-photo',
            musique: 'badge-musique'
        };

        const categorieNoms = {
            traiteur: 'Traiteur',
            decoration: 'D√©coration',
            photo: 'Photographie',
            musique: 'Musique'
        };

        function renderTable() {
            const tbody = document.getElementById('prestatairesTable');
            tbody.innerHTML = prestataires.map(p => `
                <tr>
                    <td>${p.id || '-'}</td>
                    <td><strong>${p.nom || 'Sans nom'}</strong></td>
                    <td><span class="badge ${categorieClasses[p.categorie] || 'badge-traiteur'}">${categorieNoms[p.categorie] || 'Non d√©fini'}</span></td>
                    <td>${p.tel || 'Non d√©fini'}</td>
                    <td>${p.email || 'Non d√©fini'}</td>
                    <td>${p.note ? '‚≠ê'.repeat(p.note) : 'Non not√©'}</td>
                    <td class="action-btns">
                        <button class="btn-icon" onclick="viewVendor(${p.id})" title="Voir d√©tails">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-icon" onclick="editVendor(${p.id})" title="Modifier">
                            <i class="fas fa-pen"></i>
                        </button>
                        <button class="btn-icon" onclick="deleteVendor(${p.id})" title="Supprimer">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // BOUTON VOIR - Affiche modal de d√©tails
        function viewVendor(id) {
            const vendor = prestataires.find(p => p.id === id);
            if (vendor) {
                document.getElementById('detailNom').textContent = vendor.nom;
                document.getElementById('detailCategorie').innerHTML = `<span class="badge ${categorieClasses[vendor.categorie]}">${categorieNoms[vendor.categorie]}</span>`;
                document.getElementById('detailTel').textContent = vendor.tel;
                document.getElementById('detailEmail').textContent = vendor.email;
                document.getElementById('detailNote').textContent = '‚≠ê'.repeat(vendor.note) + ` (${vendor.note}/5)`;
                document.getElementById('detailsModal').style.display = 'flex';
            }
        }

        function closeDetailsModal() {
            document.getElementById('detailsModal').style.display = 'none';
        }

        // Ouvrir modal pour ajouter
        function openAddModal() {
            document.getElementById('vendorModal').style.display = 'flex';
            document.getElementById('modalTitle').textContent = 'Ajouter un Prestataire';
            document.getElementById('vendorForm').reset();
            editingId = null;
        }

        function closeModal() {
            document.getElementById('vendorModal').style.display = 'none';
        }

        // BOUTON MODIFIER
        function editVendor(id) {
            const vendor = prestataires.find(p => p.id === id);
            if (vendor) {
                document.getElementById('vendorModal').style.display = 'flex';
                document.getElementById('modalTitle').textContent = 'Modifier Prestataire';
                document.getElementById('nom').value = vendor.nom;
                document.getElementById('categorie').value = vendor.categorie;
                document.getElementById('tel').value = vendor.tel;
                document.getElementById('email').value = vendor.email;
                document.getElementById('note').value = vendor.note;
                editingId = vendor.id;
            }
        }

        // BOUTON SUPPRIMER
        function deleteVendor(id) {
            if (confirm('Voulez-vous vraiment supprimer ce prestataire ?')) {
                prestataires = prestataires.filter(p => p.id !== id);
                allData.prestataires = prestataires;
                localStorage.setItem('goldenpromise_data', JSON.stringify(allData));
                renderTable();
            }
        }

        // Soumettre le formulaire
        document.getElementById('vendorForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const vendor = {
                id: editingId || Date.now(),
                nom: document.getElementById('nom').value,
                categorie: document.getElementById('categorie').value,
                tel: document.getElementById('tel').value,
                email: document.getElementById('email').value,
                note: parseInt(document.getElementById('note').value)
            };

            if (editingId) {
                const index = prestataires.findIndex(p => p.id === editingId);
                prestataires[index] = vendor;
            } else {
                prestataires.push(vendor);
            }

            allData.prestataires = prestataires;
            localStorage.setItem('goldenpromise_data', JSON.stringify(allData));
            
            renderTable();
            closeModal();
        });

        // BOUTON EXPORT CSV
        function exportCSV() {
            let csv = 'ID;Nom;Cat√©gorie;T√©l√©phone;Email;Note\n';
            prestataires.forEach(p => {
                csv += `${p.id};${p.nom};${categorieNoms[p.categorie] || ''};${p.tel};${p.email};${p.note}\n`;
            });
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'prestataires.csv';
            a.click();
            URL.revokeObjectURL(url);
        }

        // BARRE DE RECHERCHE
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#prestatairesTable tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(term) ? '' : 'none';
            });
        });

        // Fermer modal en cliquant en dehors
        window.onclick = function(event) {
            const modal = document.getElementById('vendorModal');
            const detailsModal = document.getElementById('detailsModal');
            if (event.target == modal) {
                closeModal();
            }
            if (event.target == detailsModal) {
                closeDetailsModal();
            }
        }

        renderTable();
    </script>

    <script>
    let currentLang = 'fr';
    
    const t = {
        fr: {
            dashboard: "Tableau de bord", clients: "Clients", mariages: "Mariages",
            prestataires: "Prestataires", paiements: "Paiements", messages: "Messages",
            logout: "D√©connexion", prestataires_title: "Gestion des Prestataires",
            prestataires_subtitle: "Liste de vos partenaires",
            search: "Rechercher...", add_vendor: "Ajouter Prestataire", export: "Export CSV",
            id: "ID", name: "Nom", category: "Cat√©gorie", phone: "T√©l√©phone",
            email: "Email", rating: "Note", actions: "Actions",
            add_vendor_title: "Ajouter un Prestataire", save: "Enregistrer", cancel: "Annuler",
            vendor_details: "üìã D√©tails du Prestataire", close: "Fermer"
        },
        en: {
            dashboard: "Dashboard", clients: "Clients", mariages: "Weddings",
            prestataires: "Vendors", paiements: "Payments", messages: "Messages",
            logout: "Logout", prestataires_title: "Vendor Management",
            prestataires_subtitle: "List of your partners",
            search: "Search...", add_vendor: "Add Vendor", export: "Export CSV",
            id: "ID", name: "Name", category: "Category", phone: "Phone",
            email: "Email", rating: "Rating", actions: "Actions",
            add_vendor_title: "Add Vendor", save: "Save", cancel: "Cancel",
            vendor_details: "üìã Vendor Details", close: "Close"
        },
        ar: {
            dashboard: "ŸÑŸàÿ≠ÿ© ÿßŸÑŸÇŸäÿßÿØÿ©", clients: "ÿßŸÑÿπŸÖŸÑÿßÿ°", mariages: "ÿ≠ŸÅŸÑÿßÿ™ ÿßŸÑÿ≤ŸÅÿßŸÅ",
            prestataires: "ŸÖŸÇÿØŸÖŸà ÿßŸÑÿÆÿØŸÖÿßÿ™", paiements: "ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™", messages: "ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ",
            logout: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨", prestataires_title: "ÿ•ÿØÿßÿ±ÿ© ŸÖŸÇÿØŸÖŸä ÿßŸÑÿÆÿØŸÖÿßÿ™",
            prestataires_subtitle: "ŸÇÿßÿ¶ŸÖÿ© ÿ¥ÿ±ŸÉÿßÿ¶ŸÉ",
            search: "ÿ®ÿ≠ÿ´...", add_vendor: "ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÇÿØŸÖ ÿÆÿØŸÖÿ©", export: "ÿ™ÿµÿØŸäÿ± CSV",
            id: "ÿßŸÑŸÖÿπÿ±ŸÅ", name: "ÿßŸÑÿßÿ≥ŸÖ", category: "ÿßŸÑŸÅÿ¶ÿ©", phone: "ÿßŸÑŸáÿßÿ™ŸÅ",
            email: "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä", rating: "ÿßŸÑÿ™ŸÇŸäŸäŸÖ", actions: "ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™",
            add_vendor_title: "ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÇÿØŸÖ ÿÆÿØŸÖÿ©", save: "ÿ≠ŸÅÿ∏", cancel: "ÿ•ŸÑÿ∫ÿßÿ°",
            vendor_details: "üìã ÿ™ŸÅÿßÿµŸäŸÑ ŸÖŸÇÿØŸÖ ÿßŸÑÿÆÿØŸÖÿ©", close: "ÿ•ÿ∫ŸÑÿßŸÇ"
        }
    };

    function setLang(lang) {
        currentLang = lang;
        localStorage.setItem('lang', lang);
        document.documentElement.lang = lang;
        document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
        
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (t[lang] && t[lang][key]) {
                if (el.placeholder !== undefined) el.placeholder = t[lang][key];
                else el.textContent = t[lang][key];
            }
        });
    }

    window.addEventListener('DOMContentLoaded', () => {
        const lang = localStorage.getItem('lang') || 'fr';
        currentLang = lang;
        setLang(lang);
        const sel = document.getElementById('langSelect');
        if (sel) sel.value = lang;
    });
    </script>

</body>
</html>
