<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©tails Client | Golden Promise</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;500&family=Montserrat:wght@300;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        :root {
            --rose-gold: #c5a059;
            --silk: #fcfaf8;
            --text: #2d2a26;
            --white: #ffffff;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--silk);
            padding: 40px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .lang-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .lang-selector select {
            padding: 12px 20px;
            border: 2px solid rgba(197, 160, 89, 0.2);
            border-radius: 50px;
            background: white;
            cursor: pointer;
            font-size: 0.85rem;
            outline: none;
            font-family: 'Montserrat', sans-serif;
        }
        
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 25px;
            background: var(--text);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            margin-bottom: 30px;
            font-size: 0.9rem;
            transition: 0.3s;
        }
        
        .back-btn:hover {
            background: var(--rose-gold);
        }
        
        .header-card {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
        }
        
        .header-card h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.5rem;
            color: var(--rose-gold);
            margin-bottom: 10px;
        }
        
        .header-card .client-id {
            color: #999;
            font-size: 0.9rem;
        }
        
        .actions-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }
        
        .btn-primary {
            background: var(--rose-gold);
            color: white;
        }
        
        .btn-success {
            background: #059669;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
        }
        
        .info-card {
            background: var(--white);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
        }
        
        .info-card h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            color: var(--text);
            margin-bottom: 25px;
            border-bottom: 2px solid var(--rose-gold);
            padding-bottom: 15px;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #f5f5f5;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            font-weight: 500;
            color: #666;
            font-size: 0.9rem;
        }
        
        .detail-value {
            color: var(--text);
            font-weight: 600;
        }
        
        .status-badge {
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .status-actif {
            background: rgba(143, 163, 130, 0.15);
            color: #5a6b4e;
        }
        
        .status-attente {
            background: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }
        
        .status-annule {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }
        
        /* RTL Support */
        body[dir="rtl"] .lang-selector {
            right: auto;
            left: 20px;
        }
        
        @media print {
            .back-btn, .actions-bar, .lang-selector { display: none; }
            body { padding: 20px; }
        }
        
        @media (max-width: 768px) {
            .details-grid {
                grid-template-columns: 1fr;
            }
            .actions-bar {
                flex-direction: column;
            }
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="lang-selector">
        <select id="langSelect" onchange="setLang(this.value)">
            <option value="fr">üá´üá∑ Fran√ßais</option>
            <option value="en">üá¨üáß English</option>
            <option value="ar">üá≤üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
        </select>
    </div>
    
    <div class="container">
        <a href="clients.html" class="back-btn">
            <i class="fas fa-arrow-left"></i> 
            <span data-i18n="back">Retour</span>
        </a>
        
        <!-- HEADER -->
        <div class="header-card" id="headerCard">
            <h1 id="clientName">üìã <span data-i18n="client_details">D√©tails du Client</span></h1>
            <p class="client-id"><span data-i18n="client_id">Client ID</span>: <span id="clientId"></span></p>
        </div>
        
        <!-- ACTIONS -->
        <div class="actions-bar">
            <button class="btn btn-primary" onclick="editClient()">
                <i class="fas fa-edit"></i> 
                <span data-i18n="edit">Modifier</span>
            </button>
            <button class="btn btn-success" onclick="exportPDF()">
                <i class="fas fa-file-pdf"></i> 
                <span data-i18n="export_pdf">Exporter en PDF</span>
            </button>
            <button class="btn btn-success" onclick="window.print()">
                <i class="fas fa-print"></i> 
                <span data-i18n="print">Imprimer</span>
            </button>
            <button class="btn btn-danger" onclick="deleteClient()">
                <i class="fas fa-trash"></i> 
                <span data-i18n="delete">Supprimer</span>
            </button>
        </div>
        
        <!-- INFO GRID -->
        <div class="details-grid">
            <!-- INFORMATIONS PERSONNELLES -->
            <div class="info-card">
                <h2>üë§ <span data-i18n="personal_info">Informations Personnelles</span></h2>
                <div id="personalInfo"></div>
            </div>
            
            <!-- D√âTAILS DU MARIAGE -->
            <div class="info-card">
                <h2>üíç <span data-i18n="wedding_details">D√©tails du Mariage</span></h2>
                <div id="weddingInfo"></div>
            </div>
            
            <!-- INFORMATIONS FINANCI√àRES -->
            <div class="info-card" style="grid-column: span 2;">
                <h2>üí∞ <span data-i18n="financial_info">Informations Financi√®res</span></h2>
                <div id="financialInfo"></div>
            </div>
        </div>
    </div>

    <script>
        let currentLang = 'fr';
        
        const t = {
            fr: {
                back: "Retour",
                client_details: "D√©tails du Client",
                client_id: "Client ID",
                edit: "Modifier",
                export_pdf: "Exporter en PDF",
                print: "Imprimer",
                delete: "Supprimer",
                personal_info: "Informations Personnelles",
                wedding_details: "D√©tails du Mariage",
                financial_info: "Informations Financi√®res",
                full_name: "Nom complet",
                partner: "Partenaire",
                email: "Email",
                phone: "T√©l√©phone",
                wedding_date: "Date du mariage",
                status: "Statut",
                guests: "Nombre d'invit√©s",
                not_specified: "Non renseign√©",
                total_budget: "Budget total",
                deposit_paid: "Acompte vers√©",
                remaining: "Reste √† payer",
                client_not_found: "Client non trouv√©",
                client_not_found_msg: "Le client demand√© n'existe pas dans la base de donn√©es.",
                back_to_list: "Retour √† la liste",
                confirm_delete: "√ätes-vous s√ªr de vouloir supprimer",
                client_deleted: "Client supprim√© !",
                actif: "Actif",
                attente: "En attente",
                annule: "Annul√©"
            },
            en: {
                back: "Back",
                client_details: "Client Details",
                client_id: "Client ID",
                edit: "Edit",
                export_pdf: "Export to PDF",
                print: "Print",
                delete: "Delete",
                personal_info: "Personal Information",
                wedding_details: "Wedding Details",
                financial_info: "Financial Information",
                full_name: "Full name",
                partner: "Partner",
                email: "Email",
                phone: "Phone",
                wedding_date: "Wedding date",
                status: "Status",
                guests: "Number of guests",
                not_specified: "Not specified",
                total_budget: "Total budget",
                deposit_paid: "Deposit paid",
                remaining: "Remaining",
                client_not_found: "Client not found",
                client_not_found_msg: "The requested client does not exist in the database.",
                back_to_list: "Back to list",
                confirm_delete: "Are you sure you want to delete",
                client_deleted: "Client deleted!",
                actif: "Active",
                attente: "Pending",
                annule: "Cancelled"
            },
            ar: {
                back: "ÿ±ÿ¨Ÿàÿπ",
                client_details: "ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿπŸÖŸäŸÑ",
                client_id: "ŸÖÿπÿ±ŸÅ ÿßŸÑÿπŸÖŸäŸÑ",
                edit: "ÿ™ÿπÿØŸäŸÑ",
                export_pdf: "ÿ™ÿµÿØŸäÿ± PDF",
                print: "ÿ∑ÿ®ÿßÿπÿ©",
                delete: "ÿ≠ÿ∞ŸÅ",
                personal_info: "ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ¥ÿÆÿµŸäÿ©",
                wedding_details: "ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ≤ŸÅÿßŸÅ",
                financial_info: "ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿßŸÑŸäÿ©",
                full_name: "ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ",
                partner: "ÿßŸÑÿ¥ÿ±ŸäŸÉ",
                email: "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
                phone: "ÿßŸÑŸáÿßÿ™ŸÅ",
                wedding_date: "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ≤ŸÅÿßŸÅ",
                status: "ÿßŸÑÿ≠ÿßŸÑÿ©",
                guests: "ÿπÿØÿØ ÿßŸÑÿ∂ŸäŸàŸÅ",
                not_specified: "ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ",
                total_budget: "ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ© ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ©",
                deposit_paid: "ÿßŸÑÿπÿ±ÿ®ŸàŸÜ ÿßŸÑŸÖÿØŸÅŸàÿπ",
                remaining: "ÿßŸÑŸÖÿ™ÿ®ŸÇŸä",
                client_not_found: "ÿßŸÑÿπŸÖŸäŸÑ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ",
                client_not_found_msg: "ÿßŸÑÿπŸÖŸäŸÑ ÿßŸÑŸÖÿ∑ŸÑŸàÿ® ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™.",
                back_to_list: "ÿßŸÑÿπŸàÿØÿ© ÿ•ŸÑŸâ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©",
                confirm_delete: "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ",
                client_deleted: "ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿπŸÖŸäŸÑ!",
                actif: "ŸÜÿ¥ÿ∑",
                attente: "ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±",
                annule: "ŸÖŸÑÿ∫Ÿâ"
            }
        };
        
        function setLang(lang) {
            currentLang = lang;
            localStorage.setItem('lang', lang);
            document.documentElement.lang = lang;
            document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
            
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[lang] && t[lang][key]) {
                    el.textContent = t[lang][key];
                }
            });
            
            if (client) {
                displayClientDetails(client);
            }
        }
        
        const urlParams = new URLSearchParams(window.location.search);
        const clientIdFromUrl = urlParams.get('id');
        
        const allData = JSON.parse(localStorage.getItem('goldenpromise_data') || '{}');
        const clients = allData.clients || [];
        
        const client = clients.find(c => c.id == clientIdFromUrl);
        
        console.log('ID recherch√©:', clientIdFromUrl);
        console.log('Clients disponibles:', clients);
        console.log('Client trouv√©:', client);
        
        if (!client) {
            document.querySelector('.container').innerHTML = `
                <div style="text-align: center; padding: 100px 20px;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 5rem; color: #ef4444; margin-bottom: 20px;"></i>
                    <h1 style="font-family: 'Cormorant Garamond', serif; font-size: 3rem; margin-bottom: 20px;" data-i18n="client_not_found">${t[currentLang].client_not_found}</h1>
                    <p style="color: #666; margin-bottom: 30px;" data-i18n="client_not_found_msg">${t[currentLang].client_not_found_msg}</p>
                    <a href="clients.html" style="display: inline-block; padding: 15px 40px; background: #c5a059; color: white; text-decoration: none; border-radius: 50px; font-weight: 600;">
                        <i class="fas fa-arrow-left"></i> <span data-i18n="back_to_list">${t[currentLang].back_to_list}</span>
                    </a>
                </div>
            `;
        } else {
            displayClientDetails(client);
        }
        
        function displayClientDetails(client) {
            document.getElementById('clientName').innerHTML = `üìã <span data-i18n="client_details">${t[currentLang].client_details}</span>: ${client.nom} & ${client.partenaire}`;
            document.getElementById('clientId').textContent = client.id;
            
            document.getElementById('personalInfo').innerHTML = `
                <div class="detail-row">
                    <span class="detail-label" data-i18n="full_name">${t[currentLang].full_name}</span>
                    <span class="detail-value">${client.nom}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label" data-i18n="partner">${t[currentLang].partner}</span>
                    <span class="detail-value">${client.partenaire}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label" data-i18n="email">${t[currentLang].email}</span>
                    <span class="detail-value">${client.email}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label" data-i18n="phone">${t[currentLang].phone}</span>
                    <span class="detail-value">${client.tel}</span>
                </div>
            `;
            
            const statusText = t[currentLang][client.statut] || client.statut;
            document.getElementById('weddingInfo').innerHTML = `
                <div class="detail-row">
                    <span class="detail-label" data-i18n="wedding_date">${t[currentLang].wedding_date}</span>
                    <span class="detail-value">${new Date(client.dateMariage).toLocaleDateString(currentLang === 'ar' ? 'ar-MA' : currentLang === 'en' ? 'en-US' : 'fr-FR', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    })}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label" data-i18n="status">${t[currentLang].status}</span>
                    <span class="status-badge status-${client.statut}">${statusText}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label" data-i18n="guests">${t[currentLang].guests}</span>
                    <span class="detail-value">${client.invites || t[currentLang].not_specified}</span>
                </div>
            `;
            
            const reste = client.budget - (client.acompte || 0);
            document.getElementById('financialInfo').innerHTML = `
                <div class="detail-row">
                    <span class="detail-label" data-i18n="total_budget">${t[currentLang].total_budget}</span>
                    <span class="detail-value">${client.budget.toLocaleString()} MAD</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label" data-i18n="deposit_paid">${t[currentLang].deposit_paid}</span>
                    <span class="detail-value">${(client.acompte || 0).toLocaleString()} MAD</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label" data-i18n="remaining">${t[currentLang].remaining}</span>
                    <span class="detail-value" style="color: ${reste > 0 ? '#ef4444' : '#059669'};">
                        ${reste.toLocaleString()} MAD
                    </span>
                </div>
            `;
        }
        
        function exportPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(20);
            doc.setTextColor(197, 160, 89);
            doc.text('Golden Promise - Fiche Client', 20, 20);
            
            doc.setDrawColor(197, 160, 89);
            doc.line(20, 25, 190, 25);
            
            doc.setFontSize(12);
            doc.setTextColor(45, 42, 38);
            
            let y = 40;
            doc.text(`${t[currentLang].full_name}: ${client.nom}`, 20, y); y += 10;
            doc.text(`${t[currentLang].partner}: ${client.partenaire}`, 20, y); y += 10;
            doc.text(`${t[currentLang].email}: ${client.email}`, 20, y); y += 10;
            doc.text(`${t[currentLang].phone}: ${client.tel}`, 20, y); y += 10;
            doc.text(`${t[currentLang].wedding_date}: ${client.dateMariage}`, 20, y); y += 10;
            doc.text(`${t[currentLang].total_budget}: ${client.budget.toLocaleString()} MAD`, 20, y); y += 10;
            doc.text(`${t[currentLang].status}: ${t[currentLang][client.statut]}`, 20, y);
            
            doc.save(`client-${client.nom.replace(/\s+/g, '-')}.pdf`);
        }
        
        function editClient() {
            window.location.href = `clients.html?edit=${client.id}`;
        }
        
        function deleteClient() {
            if (confirm(`${t[currentLang].confirm_delete} ${client.nom} ?`)) {
                const allData = JSON.parse(localStorage.getItem('goldenpromise_data') || '{}');
                allData.clients = allData.clients.filter(c => c.id != client.id);
                localStorage.setItem('goldenpromise_data', JSON.stringify(allData));
                alert(t[currentLang].client_deleted);
                window.location.href = 'clients.html';
            }
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            const lang = localStorage.getItem('lang') || 'fr';
            currentLang = lang;
            document.getElementById('langSelect').value = lang;
            setLang(lang);
        });
    </script>
</body>
</html>
